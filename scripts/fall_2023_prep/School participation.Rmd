---
title: "School participation across the year"
author: "Merly Klaas"
date: "2023-09-27"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
pacman::p_load(rio, here, dplyr,tidyverse,lubridate, ggplot2,viridis)
```

I did the initial cleaning in excel, please check sort_school_excel.xlsx if people want to see the original sheets. I then imported the cleaned dataset here. 

```{r}
school <- import(here("data", "sort.csv"))
```

## Overall Number of school participated each year

*In 2023 we have the largest number of school participated (n=251), while 2022 is the least number of school participation (n=161).*


```{r}
school %>%

    pivot_longer(cols=starts_with("year"),
               names_to = "year",
               values_to = "count", 
               names_prefix = "year_") %>% 
    drop_na() %>% 
  group_by(year) %>% 
  count() %>% 
  ggplot()+
  geom_col(aes(year, n), fill= "#1A4C81") +
   geom_text(aes(year, n,label = n), vjust = -0.5)
  
  
  
```

## Schools' repeated participation trend across the year

However, in terms of schools regular participation, we only have 25 (out of 514) schools  participated in all 4 year, 52 school participated in 3 time points, 123 schools in 2 time points, and 314 schools only 1 time point. 

```{r}
school %>% 
  count(total_count) %>% 
  ggplot()+
  geom_col(aes(total_count, n), fill="#1A4C81") +
  geom_text(aes(total_count, n,label = n), vjust=-0.5)
```

## Each year and the accumulated school participation 

Here we can see the trend of each school participation from  2019 - 2023 (gray = not participated, yellow = participated), and the far right is the total count of year participated. Color map confirmed the least participation happened in 2022. 

```{r}
school %>% 
  mutate(n = total_count) %>% 
  pivot_longer(cols = 2:6,
               names_to = "year",
               values_to = "count", 
               names_prefix = "year_") %>% 
   ggplot() +
  geom_tile(aes(year, y=fct_reorder(school_name, n), fill=count))+
   scale_fill_viridis(discrete=FALSE, direction=-1)+
  labs(y= "Nominated Schools")+
  theme(axis.text.y = element_blank())
```

```{r}


```


